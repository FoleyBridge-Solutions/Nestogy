Migrated 19 permissions to Bouncer abilities.
Migrated 0 roles to Bouncer.
Migrated 0 role-permission relationships across 0 companies.
Migrated 0 user role assignments.
Migrated 0 direct user permissions.
Dropped legacy permission system tables.
The system now uses Bouncer for role and permission management.

   FAIL  Tests\Unit\Controllers\TicketControllerTest
  âœ“ generate ticket number creates unique number                        13.36s  
  â¨¯ generate ticket number increments sequence                           0.24s  
  âœ“ get filter options returns correct structure                         0.20s  
  âœ“ get filter options includes valid statuses                           0.19s  
  âœ“ get filter options includes valid priorities                         0.17s  
  âœ“ track ticket view stores in cache                                    0.21s  
  âœ“ track ticket view stores user information                            0.22s  
  âœ“ get ticket viewers excludes current user                             0.22s  
  âœ“ get ticket viewers excludes old views                                0.22s  
  âœ“ track ticket changes logs status changes                             0.22s  
  âœ“ track ticket changes logs priority changes                           0.23s  
  âœ“ track ticket changes logs assignment changes                         0.22s  
  âœ“ get today time statistics returns correct structure                  0.19s  
  â¨¯ get today time statistics calculates total hours                     0.21s  
  âœ“ index request includes pagination                                    1.37s  
  âœ“ index request applies sorting                                        0.24s  
  âœ“ create request provides form data                                    0.15s  
  âœ“ create request includes priority options                             0.17s  
  âœ“ create request includes status options                               0.19s  
  âœ“ export request generates csv headers                                 0.26s  
  âœ“ search request requires minimum query length                         0.16s  
  âœ“ search request limits results                                        0.67s  
  âœ“ search request excludes closed tickets                               0.27s  

   FAIL  Tests\Feature\Controllers\TicketControllerTest
  âœ“ index displays tickets list                                          0.77s  
  âœ“ index filters by search term                                         0.28s  
  âœ“ index filters by status                                              0.26s  
  âœ“ index filters by priority                                            0.27s  
  âœ“ index filters by assignee                                            0.30s  
  âœ“ index filters overdue tickets                                        0.29s  
  âœ“ index filters unassigned tickets                                     0.30s  
  âœ“ index filters watched tickets                                        0.35s  
  âœ“ create displays form                                                 0.38s  
  âœ“ store creates ticket                                                 0.22s  
  âœ“ store creates watcher for creator                                    0.22s  
  â¨¯ store generates unique ticket number                                 0.25s  
  âœ“ store validates required fields                                      0.23s  
  â¨¯ store validates client belongs to company                            0.21s  
  âœ“ store validates priority values                                      0.21s  
  âœ“ store returns json when requested                                    0.22s  
  âœ“ show displays ticket                                                 0.63s  
  âœ“ show tracks viewer                                                   0.46s  
  âœ“ show returns json when requested                                     0.27s  
  â¨¯ edit displays form                                                   0.38s  
  â¨¯ update modifies ticket                                               0.38s  
  â¨¯ update validates input                                               0.38s  
  â¨¯ destroy soft deletes ticket                                          0.39s  
  â¨¯ destroy returns json when requested                                  0.26s  
  â¨¯ assign updates ticket assignee                                       0.24s  
  â¨¯ assign creates watcher for assignee                                  0.25s  
  â¨¯ assign validates assignee belongs to company                         0.23s  
  â¨¯ update status changes ticket status                                  0.24s  
  â¨¯ update status sets closed timestamps                                 0.25s  
  â¨¯ update priority changes ticket priority                              0.25s  
  â¨¯ schedule creates calendar event                                      0.24s  
  â¨¯ schedule validates future date                                       0.25s  
  â¨¯ merge moves data to target ticket                                    0.28s  
  â¨¯ merge validates target ticket exists                                 0.26s  
  â¨¯ merge prevents self merge                                            0.25s  
  âœ“ export generates csv                                                 0.31s  
  â¨¯ search finds tickets by number                                       0.25s  
  âœ“ search finds tickets by subject                                      0.24s  
  âœ“ search excludes specified ticket                                     0.29s  
  âœ“ get viewers returns other viewers                                    0.27s  
  â¨¯ start smart timer creates time entry                                 0.32s  
  âœ“ stop timer ends active timer                                         0.27s  
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Unit\Controllers\TicketControllerTest > generate ticket numâ€¦   
  Failed asserting that two strings are equal.
  -'TKT-2025-000002'
  +'TKT-2025-000001'
  

  at tests/Unit/Controllers/TicketControllerTest.php:79
     75â–•         $method->setAccessible(true);
     76â–• 
     77â–•         $number = $method->invoke($this->controller);
     78â–• 
  âžœ  79â–•         $this->assertEquals("TKT-{$currentYear}-000002", $number);
     80â–•     }
     81â–• 
     82â–•     public function test_get_filter_options_returns_correct_structure(): void
     83â–•     {

  1   tests/Unit/Controllers/TicketControllerTest.php:79

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Unit\Controllers\TicketControllerTest > get today time statâ€¦   
  Failed asserting that 1 matches expected 2.

  at tests/Unit/Controllers/TicketControllerTest.php:335
    331â–•         $stats = $method->invoke($this->controller, $this->user);
    332â–• 
    333â–•         $this->assertEquals(4.0, $stats['total_hours']);
    334â–•         $this->assertEquals(2.5, $stats['billable_hours']);
  âžœ 335â–•         $this->assertEquals(2, $stats['entries_count']);
    336â–•     }
    337â–• 
    338â–•     public function test_index_request_includes_pagination(): void
    339â–•     {

  1   tests/Unit/Controllers/TicketControllerTest.php:335

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest > store generatesâ€¦    
  Expected: 1001

  To contain: TKT

  at tests/Feature/Controllers/TicketControllerTest.php:291
    287â–•         $this->actingAs($this->user)->post(route('tickets.store'), $data);
    288â–• 
    289â–•         $ticket = Ticket::where('subject', 'Test Ticket')->first();
    290â–•         $this->assertNotNull($ticket->number);
  âžœ 291â–•         $this->assertStringContainsString('TKT', $ticket->number);
    292â–•     }
    293â–• 
    294â–•     public function test_store_validates_required_fields(): void
    295â–•     {

  1   tests/Feature/Controllers/TicketControllerTest.php:291

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest >â€¦   QueryException   
  SQLSTATE[23503]: Foreign key violation: 7 ERROR:  insert or update on table "clients" violates foreign key constraint "clients_company_id_foreign"
DETAIL:  Key (company_id)=(999) is not present in table "companies". (Connection: pgsql, SQL: insert into "clients" ("company_id", "name", "company_name", "type", "email", "phone", "website", "address", "city", "state", "zip_code", "country", "status", "notes", "hourly_rate", "billing_contact", "technical_contact", "created_at", "updated_at") values (999, Prosacco, Yundt and Davis, Wuckert LLC Inc., company, aurelia.abshire@gerlach.com, (563) 475-6035, ?, 513 Bernhard Views Suite 919, Corkeryberg, KY, 75298, United States, suspended, ?, 225, Prof. Cordia Dooley, Constantin Stamm Sr., 2025-10-06 16:42:15, 2025-10-06 16:42:15) returning "id")

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:824
    820â–•                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    821â–•                 );
    822â–•             }
    823â–• 
  âžœ 824â–•             throw new QueryException(
    825â–•                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    826â–•             );
    827â–•         }
    828â–•     }

      [2m+18 vendor frames [22m
  19  tests/Feature/Controllers/TicketControllerTest.php:303

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest > edit displays foâ€¦   
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests/Feature/Controllers/TicketControllerTest.php:409
    405â–•         ]);
    406â–• 
    407â–•         $response = $this->actingAs($this->user)->get(route('tickets.edit', $ticket));
    408â–• 
  âžœ 409â–•         $response->assertStatus(200);
    410â–•         $response->assertViewIs('tickets.edit');
    411â–•         $response->assertViewHas(['ticket', 'clients', 'assignees']);
    412â–•     }
    413â–•

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest > update modifiesâ€¦    
  Expected response status code [201, 301, 302, 303, 307, 308] but received 403.
Failed asserting that false is true.

  at tests/Feature/Controllers/TicketControllerTest.php:433
    429â–• 
    430â–•         $response = $this->actingAs($this->user)
    431â–•             ->put(route('tickets.update', $ticket), $data);
    432â–• 
  âžœ 433â–•         $response->assertRedirect();
    434â–•         $this->assertDatabaseHas('tickets', [
    435â–•             'id' => $ticket->id,
    436â–•             'priority' => 'Critical',
    437â–•             'status' => 'in_progress',

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest > update validatesâ€¦   
  Session is missing expected key [errors].
Failed asserting that false is true.

  at tests/Feature/Controllers/TicketControllerTest.php:451
    447â–• 
    448â–•         $response = $this->actingAs($this->user)
    449â–•             ->put(route('tickets.update', $ticket), []);
    450â–• 
  âžœ 451â–•         $response->assertSessionHasErrors(['client_id', 'subject', 'details', 'priority', 'status']);
    452â–•     }
    453â–• 
    454â–•     public function test_destroy_soft_deletes_ticket(): void
    455â–•     {

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest > destroy soft delâ€¦   
  Expected response status code [201, 301, 302, 303, 307, 308] but received 403.
Failed asserting that false is true.

  at tests/Feature/Controllers/TicketControllerTest.php:464
    460â–• 
    461â–•         $response = $this->actingAs($this->user)
    462â–•             ->delete(route('tickets.destroy', $ticket));
    463â–• 
  âžœ 464â–•         $response->assertRedirect(route('tickets.index'));
    465â–•         $this->assertSoftDeleted('tickets', ['id' => $ticket->id]);
    466â–•     }
    467â–• 
    468â–•     public function test_destroy_returns_json_when_requested(): void

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest > destroy returnsâ€¦    
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests/Feature/Controllers/TicketControllerTest.php:478
    474â–• 
    475â–•         $response = $this->actingAs($this->user)
    476â–•             ->deleteJson(route('tickets.destroy', $ticket));
    477â–• 
  âžœ 478â–•         $response->assertStatus(200);
    479â–•         $response->assertJson(['success' => true]);
    480â–•     }
    481â–• 
    482â–•     public function test_assign_updates_ticket_assignee(): void

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest > assign updates tâ€¦   
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests/Feature/Controllers/TicketControllerTest.php:497
    493â–•             ->postJson(route('tickets.assign', $ticket), [
    494â–•                 'assigned_to' => $assignee->id,
    495â–•             ]);
    496â–• 
  âžœ 497â–•         $response->assertStatus(200);
    498â–•         $this->assertDatabaseHas('tickets', [
    499â–•             'id' => $ticket->id,
    500â–•             'assigned_to' => $assignee->id,
    501â–•         ]);

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest > assign creates wâ€¦   
  Failed asserting that a row in the table [ticket_watchers] matches the attributes {
    "ticket_id": 90,
    "user_id": 167
}.

The table is empty.

  at tests/Feature/Controllers/TicketControllerTest.php:517
    513â–•         $this->actingAs($this->user)->postJson(route('tickets.assign', $ticket), [
    514â–•             'assigned_to' => $assignee->id,
    515â–•         ]);
    516â–• 
  âžœ 517â–•         $this->assertDatabaseHas('ticket_watchers', [
    518â–•             'ticket_id' => $ticket->id,
    519â–•             'user_id' => $assignee->id,
    520â–•         ]);
    521â–•     }

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest >â€¦   QueryException   
  SQLSTATE[23503]: Foreign key violation: 7 ERROR:  insert or update on table "users" violates foreign key constraint "users_company_id_foreign"
DETAIL:  Key (company_id)=(999) is not present in table "companies". (Connection: pgsql, SQL: insert into "users" ("company_id", "name", "email", "email_verified_at", "password", "remember_token", "updated_at", "created_at") values (999, Jadyn Fisher II, kale53@example.net, 2025-10-06 16:42:19, $2y$04$Gk86BscLvl70KNLyCkqRauFeTSj8/YCIN1geACiJpEpWRCGJMHG2m, CFZpKEe35G, 2025-10-06 16:42:19, 2025-10-06 16:42:19) returning "id")

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:824
    820â–•                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    821â–•                 );
    822â–•             }
    823â–• 
  âžœ 824â–•             throw new QueryException(
    825â–•                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    826â–•             );
    827â–•         }
    828â–•     }

      [2m+18 vendor frames [22m
  19  tests/Feature/Controllers/TicketControllerTest.php:530

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest > update status châ€¦   
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests/Feature/Controllers/TicketControllerTest.php:553
    549â–•             ->postJson(route('tickets.update-status', $ticket), [
    550â–•                 'status' => 'in_progress',
    551â–•             ]);
    552â–• 
  âžœ 553â–•         $response->assertStatus(200);
    554â–•         $this->assertDatabaseHas('tickets', [
    555â–•             'id' => $ticket->id,
    556â–•             'status' => 'in_progress',
    557â–•         ]);

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest > update status seâ€¦   
  Failed asserting that null is not null.

  at tests/Feature/Controllers/TicketControllerTest.php:573
    569â–•             'status' => 'closed',
    570â–•         ]);
    571â–• 
    572â–•         $ticket->refresh();
  âžœ 573â–•         $this->assertNotNull($ticket->closed_at);
    574â–•         $this->assertEquals($this->user->id, $ticket->closed_by);
    575â–•     }
    576â–• 
    577â–•     public function test_update_priority_changes_ticket_priority(): void

  1   tests/Feature/Controllers/TicketControllerTest.php:573

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest > update priorityâ€¦    
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests/Feature/Controllers/TicketControllerTest.php:590
    586â–•             ->postJson(route('tickets.update-priority', $ticket), [
    587â–•                 'priority' => 'Critical',
    588â–•             ]);
    589â–• 
  âžœ 590â–•         $response->assertStatus(200);
    591â–•         $this->assertDatabaseHas('tickets', [
    592â–•             'id' => $ticket->id,
    593â–•             'priority' => 'Critical',
    594â–•         ]);

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest > schedule createsâ€¦   
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests/Feature/Controllers/TicketControllerTest.php:613
    609â–•                 'duration' => 120,
    610â–•                 'location' => 'Client Office',
    611â–•             ]);
    612â–• 
  âžœ 613â–•         $response->assertStatus(200);
    614â–•         $this->assertDatabaseHas('tickets', [
    615â–•             'id' => $ticket->id,
    616â–•             'scheduled_at' => $scheduledTime,
    617â–•         ]);

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest > schedule validatâ€¦   
  Expected response status code [422] but received 403.
Failed asserting that 403 is identical to 422.

  at tests/Feature/Controllers/TicketControllerTest.php:632
    628â–•             ->postJson(route('tickets.schedule', $ticket), [
    629â–•                 'scheduled_at' => now()->subDay()->toDateTimeString(),
    630â–•             ]);
    631â–• 
  âžœ 632â–•         $response->assertStatus(422);
    633â–•     }
    634â–• 
    635â–•     public function test_merge_moves_data_to_target_ticket(): void
    636â–•     {

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest > merge moves dataâ€¦   
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests/Feature/Controllers/TicketControllerTest.php:654
    650â–•             ->postJson(route('tickets.merge', $sourceTicket), [
    651â–•                 'merge_into_number' => $targetTicket->number,
    652â–•             ]);
    653â–• 
  âžœ 654â–•         $response->assertStatus(200);
    655â–•         $sourceTicket->refresh();
    656â–•         $this->assertEquals('closed', $sourceTicket->status);
    657â–•     }
    658â–•

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest > merge validatesâ€¦    
  Expected response status code [404] but received 403.
Failed asserting that 403 is identical to 404.

  at tests/Feature/Controllers/TicketControllerTest.php:671
    667â–•             ->postJson(route('tickets.merge', $ticket), [
    668â–•                 'merge_into_number' => 'INVALID-999999',
    669â–•             ]);
    670â–• 
  âžœ 671â–•         $response->assertStatus(404);
    672â–•     }
    673â–• 
    674â–•     public function test_merge_prevents_self_merge(): void
    675â–•     {

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest > merge prevents sâ€¦   
  Expected response status code [422] but received 403.
Failed asserting that 403 is identical to 422.

  at tests/Feature/Controllers/TicketControllerTest.php:686
    682â–•             ->postJson(route('tickets.merge', $ticket), [
    683â–•                 'merge_into_number' => $ticket->number,
    684â–•             ]);
    685â–• 
  âžœ 686â–•         $response->assertStatus(422);
    687â–•     }
    688â–• 
    689â–•     public function test_export_generates_csv(): void
    690â–•     {

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest > search finds ticâ€¦   
  Failed to assert that the response count matched the expected 1
Failed asserting that actual size 0 matches expected size 1.

  at tests/Feature/Controllers/TicketControllerTest.php:714
    710â–•         $response = $this->actingAs($this->user)
    711â–•             ->getJson(route('tickets.search', ['q' => '000001']));
    712â–• 
    713â–•         $response->assertStatus(200);
  âžœ 714â–•         $response->assertJsonCount(1, 'tickets');
    715â–•     }
    716â–• 
    717â–•     public function test_search_finds_tickets_by_subject(): void
    718â–•     {

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\Controllers\TicketControllerTest > start smart timeâ€¦   
  Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.

The following exception occurred during the last request:

Error: Class "App\Domains\Product\Services\RateConfigurationService" not found in /opt/nestogy/app/Domains/Ticket/Services/TimeTrackingService.php:28
Stack trace:
#0 /opt/nestogy/app/Domains/Ticket/Controllers/TicketController.php(1543): [constant expression]()
#1 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Routing/Controller.php(54): App\Domains\Ticket\Controllers\TicketController->startSmartTimer()
#2 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(43): Illuminate\Routing\Controller->callAction()
#3 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Routing/Route.php(265): Illuminate\Routing\ControllerDispatcher->dispatch()
#4 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Routing/Route.php(211): Illuminate\Routing\Route->runController()
#5 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Routing/Router.php(822): Illuminate\Routing\Route->run()
#6 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(180): Illuminate\Routing\Router->{closure:Illuminate\Routing\Router::runRouteWithinStack():821}()
#7 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->{closure:Illuminate\Pipeline\Pipeline::prepareDestination():178}()
#8 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle()
#9 /opt/nestogy/vendor/barryvdh/laravel-debugbar/src/Middleware/InjectDebugbar.php(59): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#10 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Barryvdh\Debugbar\Middleware\InjectDebugbar->handle()
#11 /opt/nestogy/app/Http/Middleware/SetupWizardMiddleware.php(37): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#12 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): App\Http\Middleware\SetupWizardMiddleware->handle()
#13 /opt/nestogy/app/Http/Middleware/AutoVerifyEmailWithoutSMTP.php(31): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#14 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): App\Http\Middleware\AutoVerifyEmailWithoutSMTP->handle()
#15 /opt/nestogy/app/Http/Middleware/ConfigureCompanyMail.php(34): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#16 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): App\Http\Middleware\ConfigureCompanyMail->handle()
#17 /opt/nestogy/app/Http/Middleware/SetBouncerScope.php(34): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#18 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): App\Http\Middleware\SetBouncerScope->handle()
#19 /opt/nestogy/app/Http/Middleware/RememberTokenMiddleware.php(37): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#20 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): App\Http\Middleware\RememberTokenMiddleware->handle()
#21 /opt/nestogy/app/Http/Middleware/LogSignupRequests.php(27): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#22 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): App\Http\Middleware\LogSignupRequests->handle()
#23 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#24 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Routing\Middleware\SubstituteBindings->handle()
#25 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(63): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#26 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Auth\Middleware\Authenticate->handle()
#27 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(87): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#28 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle()
#29 /opt/nestogy/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(48): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#30 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\View\Middleware\ShareErrorsFromSession->handle()
#31 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(120): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#32 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(63): Illuminate\Session\Middleware\StartSession->handleStatefulRequest()
#33 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Session\Middleware\StartSession->handle()
#34 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(36): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#35 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle()
#36 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(74): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#37 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Cookie\Middleware\EncryptCookies->handle()
#38 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(137): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#39 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Routing/Router.php(821): Illuminate\Pipeline\Pipeline->then()
#40 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Routing/Router.php(800): Illuminate\Routing\Router->runRouteWithinStack()
#41 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Routing/Router.php(764): Illuminate\Routing\Router->runRoute()
#42 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Routing/Router.php(753): Illuminate\Routing\Router->dispatchToRoute()
#43 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router->dispatch()
#44 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(180): Illuminate\Foundation\Http\Kernel->{closure:Illuminate\Foundation\Http\Kernel::dispatchToRouter():197}()
#45 /opt/nestogy/vendor/livewire/livewire/src/Features/SupportDisablingBackButtonCache/DisableBackButtonCacheMiddleware.php(19): Illuminate\Pipeline\Pipeline->{closure:Illuminate\Pipeline\Pipeline::prepareDestination():178}()
#46 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Livewire\Features\SupportDisablingBackButtonCache\DisableBackButtonCacheMiddleware->handle()
#47 /opt/nestogy/vendor/barryvdh/laravel-debugbar/src/Middleware/InjectDebugbar.php(59): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#48 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Barryvdh\Debugbar\Middleware\InjectDebugbar->handle()
#49 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#50 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#51 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle()
#52 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#53 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#54 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\TrimStrings->handle()
#55 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#56 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\ValidatePostSize->handle()
#57 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(109): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#58 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle()
#59 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(48): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#60 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\HandleCors->handle()
#61 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#62 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\TrustProxies->handle()
#63 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#64 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle()
#65 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePathEncoding.php(26): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#66 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(219): Illuminate\Http\Middleware\ValidatePathEncoding->handle()
#67 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(137): Illuminate\Pipeline\Pipeline->{closure:{closure:Illuminate\Pipeline\Pipeline::carry():194}:195}()
#68 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline->then()
#69 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter()
#70 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle()
#71 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase->call()
#72 /opt/nestogy/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase->json()
#73 /opt/nestogy/tests/Feature/Controllers/TicketControllerTest.php(785): Illuminate\Foundation\Testing\TestCase->postJson()
#74 /opt/nestogy/vendor/phpunit/phpunit/src/Framework/TestCase.php(1657): Tests\Feature\Controllers\TicketControllerTest->test_start_smart_timer_creates_time_entry()
#75 /opt/nestogy/vendor/phpunit/phpunit/src/Framework/TestCase.php(515): PHPUnit\Framework\TestCase->runTest()
#76 /opt/nestogy/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase->runBare()
#77 /opt/nestogy/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner->run()
#78 /opt/nestogy/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase->run()
#79 /opt/nestogy/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#80 /opt/nestogy/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#81 /opt/nestogy/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#82 /opt/nestogy/vendor/phpunit/phpunit/src/TextUI/Application.php(211): PHPUnit\TextUI\TestRunner->run()
#83 /opt/nestogy/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run()
#84 {main}

----------------------------------------------------------------------------------

Class "App\Domains\Product\Services\RateConfigurationService" not found

  at tests/Feature/Controllers/TicketControllerTest.php:790
    786â–•                 'work_type' => 'general_support',
    787â–•                 'description' => 'Working on ticket',
    788â–•             ]);
    789â–• 
  âžœ 790â–•         $response->assertStatus(200);
    791â–•         $response->assertJson(['success' => true]);
    792â–•     }
    793â–• 
    794â–•     public function test_stop_timer_ends_active_timer(): void


  Tests:    22 failed, 43 passed (143 assertions)
  Duration: 32.39s

